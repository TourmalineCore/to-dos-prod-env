repositories:
  - name: ingress-nginx
    url: https://kubernetes.github.io/ingress-nginx
  - name: jetstack
    url: https://charts.jetstack.io

releases:
  - name: cert-manager
    wait: true
    chart: jetstack/cert-manager
    version: 1.14.5
    values:
      - values-cert-manager.yaml.gotmpl
      - extraDeploy:
        - |-
            apiVersion: cert-manager.io/v1
            kind: ClusterIssuer
            metadata:
              name: letsencrypt
              namespace: cert-manager
            spec:
              acme:
                # The ACME server URL
                server: https://acme-v02.api.letsencrypt.org/directory
                # Email address used for ACME registration
                email: {{ requiredEnv "LETSENCRYPT_EMAIL" }}
                # Name of a secret used to store the ACME account private key
                privateKeySecretRef:
                  name: letsencrypt
                # Enable the HTTP-01 challenge provider
                solvers:
                - http01:
                    ingress:
                      class: nginx

  - name: ingress-nginx
    labels:
      app: ingress-nginx
    wait: true
    chart: ingress-nginx/ingress-nginx
    version: 4.10.1
    values:
      - values-ingress-nginx.yaml.gotmpl
